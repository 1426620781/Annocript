                          |------------------------------------| 
                          |  Annocript 0.2  configure and run! | 
                          |------------------------------------| 


------------- 
Configuration 
------------- 

After installing, copy the default config_user.txt file from the Annocript folder to your 
working directory (ann_works) and open it. There you can set the parameters you need. 

              ---------------- TERMINAL ------------------ 
              francesco@compaq2:~/Annocript$ cd ../ann_works 
              francesco@compaq2:~/ann_works$ cp ../Annocript/CONFIGURATION/config_user.txt  . 
              ---------------- TERMINAL ------------------ 

The first time you run Annocript you have to fix some important parameters in the config_user.txt file. 
These parameters will not change anymore after you set them the first time. Then you can keep that configuration file in your working folder and modify it everytime you need a different analysis. 
To open and write the configuration file you may use a simple text editor, I use nano: 

                ---------------- TERMINAL ------------------ 
                francesco@compaq2:~/ann_works$ nano config_user.txt 
                ---------------- TERMINAL ------------------ 


*Using GFF DB 

This variable permits the printing of the GFF output files and the usage of the GFF database in addition to the classical MySQL tabular always used by Annocript. Use YES only if you think you will need results also in GFF format. 
        
        useGFFDB = NO 


Once the fixed parameters have been set, you can continue with the customizable part. 

The first parameter is the name of your FASTA file: 
        fastaSeqs = 
        
IMPORTANT: The name of the file with sequences must respect these constrains:        
1. the extension must be .fasta or .fa; 
2. the overall lenght (with  extension) must be no longer than 50 chars; 
3. the name has not to contain dots. Only the one which separates the extension is accepted; 
4. chars accepted in the name are: A-z,a-z,0-9,_,-. 
5. the fasta file must be into the working directory (ann_works)

If these constrains are not respected Annocript will die and you will have to change the sequences file names. 
The rest of the parameters regard the programs inputs. You may want to change them but we suggest strongly to not 
change them if you don't know what you are doing. 

Reach the final part of the file (FIXED PARAMETERS) and do the following: 

*Database account Info 
You have to replace here your account informations to access the MySQL database. 
        mySqlUser  //Username for mysql in your sistem 
        mySqlPass  //Password for mysql in your sistem 


IMPORTANT: To use Annocript you need access to a MySQL server with an account with grants to create databases
 and tables and insert/modify/delete rows. If you don't have, please contact your system administrator. 
 

*Uniprot user access 
Here you choose the account name and password to access and download from UNIPROT: 

        uniprotWebUser = anonymous (you can leave this) 
        uniprotWebPass = youremail@the_domain.com 


*Programs paths 
Here you need to add paths to the programs that depend on the folder where you chose to install. 

        #Programs Paths 
        blastPath = /home/francesco/bin/blast/bin/ 
        portraitPath = /home/francesco/bin/portrait/portrait-1.1.pl 
        dna2pepPath = /home/francesco/bin/dna2pep/dna2pep.py 

Be careful! Often errors in writing this links properly leads to errors like "cannot find /path/to/program". To avoid it we suggest
to keep in mind that: 1. blastPath should finish with '/'; 2. for portrait and dna2pep paths are the complete path to the program.


Now you are ready to use Annocript! 

In the following is shown how to make different things. You should first create a database for proteins and then 
run the programs. If you need only to do one of the three steps you can skip to ADVANCED_USAGE.txt file. 

READ CAREFULLY: Depending upon your network you could experience some problems during the automatical download and uncompression of Uniprot files or other flat files used as sequences/annotation sources. 
Some Warnings also can come out because of problems with connection on your client and db servers. If you meet some of 
these problems during the Annocript run we suggest to download and uncompress the flat files manually from the addresses indicated in the “Links to Files” section of the
config_annocript.txt file and follow carefully instructions on "How to run Annocript with already downloaded db files" 
in Appendix guide section. 

--------------------------------- 
Annocript fast complete execution 
--------------------------------- 


After that the fixed parameters have been set, you can start Annocript and its analysis. 

Put the file with your sequences inside your working directory folder (ann_works).

Suppose the sequence are in the file trial_transcriptome.txt: it must be placed in your session folder (e.g. ann_works). 


Then open the user config file: 

                ---------------- TERMINAL ------------------ 
                francesco@compaq2:~/ann_works$ nano config_user.txt 
                ---------------- TERMINAL ------------------ 

and set the following: 

                ---------------- TERMINAL ------------------ 
                doDbCreation = YES 
                doExecutePrograms = YES 
                doBuildOutput = YES 
                extractStatistics = YES 
                ---------------- TERMINAL ------------------ 

You should also set the number of threads you want to use (depending from the number of processors you have on your 
system) and the name of the file with transcripts. 

                ---------------- TERMINAL ------------------ 
                fastaSeqs = trial_transcriptome.fasta 
                .... 
                .... 
                #Number of threads for parallel executions (Actually used for RPSBLAST) 
		threads4Parallel = 20 
                ---------------- TERMINAL ------------------ 

Then close the editor and run Annocript: 

                ---------------- TERMINAL ------------------ 
                francesco@compaq2:~/ann_works$ ../Annocript/the_annocript.pl config_user.txt 
                ---------------- TERMINAL ------------------ 

Annocript will ask to you to choose something. Please keep at hand this guide while you are running our software 
to know how to answer. 

                ---------------- TERMINAL ------------------ 
                1. New session - 2. Use Previous - 3. Exit 
                Your choose: 1 
                Choose Name: myProject 
                
                A folder will be created with this new name. 
                
                Copying the given config file in /home/francesco/ann_works/jobs/myProject 
                ##################################################### 
                # CHECKING THE INTEGRITY OF THE CONFIGURATION FILES # 
                ##################################################### 
                
                They are good. Annocript can proceed! 
                ################################### 
                # RUNNING ANNOCRIPT CONFIGURATION # 
                ################################### 
                
                DB file will be downloaded from UNIPROT website and DB built. 
                Some programs will be run. In the following are listed 
                A BLASTx  of your sequences will be done. 
                A rpsBLAST of your sequences will be done. 
                A BLASTn  of your sequences will be done. 
                PORTRAIT will be executed with your sequences. 
                DNA2PEP will be executed with your sequences. 
                The final table will be built 
                A web page and file with statistics will be created 
                Do you agree with it?(y or n) 
                y 
                ---------------- TERMINAL ------------------ 


(NOTICE: if you forgot to insert the sequences in the working directory (ann_works) but you already choose a new session 
(MyProject), Annocript will create an empty session but will give you an error. Launch it again but now shift the 
fasta file (e.g. trial_transcripts.txt) in the session folder (e.g. myProject), chose the "Use Previous" option and chose your just created 
session (myProject).) 

Once you accepted the configuration Annocript will create folders and will control your parameters: 

                ---------------- TERMINAL ------------------ 
                /home/francesco/ann_work/jobs/myProject/output/blastx doesn't exists. Creating it... 
                /home/francesco/ann_work/jobs/myProject/output/rpstblastn doesn't exists. Creating it... 
                /home/francesco/ann_work/jobs/myProject/output/blastn doesn't exists. Creating it... 
                /home/francesco/ann_work/jobs/myProject/gff doesn't exists. Creating it... 
                
                >>> Database settings (if you chose to create the database, it will need a while): 
                Checking the links...DONE! 
                You chose to create the database. Do you want to create with UNIREF (r) or UNIPROT (p)? (r or p) r 
                ---------------- TERMINAL ------------------ 

Once you choose the database to use Annocript will download the version and set the folder for the data: 

                ---------------- TERMINAL ------------------ 
                 Downloading File: ftp://ftp.uniprot.org/pub/databases/uniprot/current_release/uniref/uniref90/uniref90.release_note 
                ftp://ftp.uniprot.org/pub/databases/uniprot/current_release/uniref/uniref90/uniref90.release_note downloaded successfully! 
                kbVersion: 2013_10 
                Folder for DB will be: /home/francesco/ann_works/data/2013_10 and database name: uniref_2013_10 
                /home/francesco/ann_work/data/2013_10 doesn't exists. Creating folder /home/francesco/ann_work/data/2013_10... 
                Conserved domains database: Cdd_LE 
                
                During this process Annocript will download a set of files with big dimensions. These data will be used to create a large database with all the data. Do you want that Annocript erase them? (y or n). Press x to exit Annocript. 
                n 
                ---------------- TERMINAL ------------------ 

If you don't delete the compressed file, if there will be some error, you'll not need to download them again. We suggest to 
do this the first time you create a database. 

Other controls will be performed on parameters of programs execution and statistics: 

                ---------------- TERMINAL ------------------ 
                >>> Programs settings: 
                Path to control for fasta: /home/francesco/ann_works/trial_transcriptome.fasta 
                Sequences found in your working folder. Moving in session folder... 
                Annocript detected that your sequences are transcripts 
                Number of sequences: 333 
                 
                >>> Setting final statistics and outputs 
                ..OK! WELL DONE! 
                Your configuration has been saved! A log file will be created in 
                /home/francesco/ann_works/jobs/myProject/log/annocript_exec_Thu_Nov__7_12:56:42_2013.log. 
                The overall computation usually depends from the number of sequences and the speed of the machine you 
                are using. 
                You will find all the results in the folder you chose here. 
                
                Please let us know if some problem occurs during the computation or you don't  retrieve what you are 
                expecting from Annocript. 
                ########################################## 
                # STARTING ANNOCRIPT IN BACKGROUND! BYE! # 
                ########################################## 
                ---------------- TERMINAL ------------------ 


At this point Annocript is running! 
You can look at the log file to see the current state with the linux program 'more'. 
You may want to know if Annocript is actually running. Watch this by using the 'htop' linux command. You should see the 
command "perl annocript_executor.pl path/to/yourSequences.fasta" running. Alternatively you can use the command “ps aux | grep annocript” into the shell.